!function(e,i){"use strict";Genki.appendix={jisho:{mode:"ja",selected:[],cache:{box:{},group:{},search:{ja:[],en:[]}},init:function(){var e,s,n,a,t,l,r,c,o,p=storageOK&&localStorage.selectedDefinitions?localStorage.selectedDefinitions.split(","):[],u=[],d={},h=0;for(s in Genki.jisho){for(l=i.getElementById("list-"+s),r=i.createDocumentFragment(),g=0,k=Genki.jisho[s].length;g<k;g++)Genki.jisho[s][g].en&&((e=i.createElement("LI")).className="definition clear",e.dataset.def=s+g,n=Genki.jisho[s][g].ja.split("|"),e.innerHTML='<input class="def-selector genki_input_hidden" type="checkbox" onchange="Genki.appendix.jisho.updateCheckboxes(this, \''+e.dataset.def+"');\""+(-1!=p.indexOf(e.dataset.def)?"checked":"")+'><span tabindex="0" class="genki_pseudo_checkbox" onclick="this.previousSibling.click();" onkeypress="event.key == \'Enter\' && this.previousSibling.click();"></span><span class="def-ja'+(n[1]?" def-furi":"")+'">'+n[0]+(n[1]?"<i>"+n[1]+"</i>":"")+'</span><span class="def-en">'+Genki.jisho[s][g].en+"</span>"+(Genki.jisho[s][g].v?' <span class="def-vtype">[<i>'+Genki.jisho[s][g].v+"</i>]</span>":"")+'<span class="def-label">'+Genki.jisho[s][g].l+"</span>",r.appendChild(e),d[t=Genki.jisho[s][g].en.replace(/^\(.*?\) |^to be |^to |^the |^it |^\.\.\.(?:,|)|^\d+-|^\d+|^"|^-/i,"").toLowerCase()]&&(t=t+"-"+ ++h),d[t]=e.cloneNode(!0),u.push(t),Genki.appendix.jisho.cache.box[e.dataset.def]={ja:e.firstChild},Genki.appendix.jisho.cache.group[s]||(Genki.appendix.jisho.cache.group[s]=[]),Genki.appendix.jisho.cache.group[s].push(e.firstChild),Genki.appendix.jisho.cache.search.ja.push(e));l.appendChild(r)}for(u=u.sort(),c="A",r=i.createDocumentFragment(),g=0,k=u.length;g<k;g++)(o=u[g].charAt(0))!=c&&(/[a-z]/.test(o)?(i.getElementById("list-"+c).appendChild(r),c=o.toUpperCase(),r=i.createDocumentFragment()):console.error('STRING CLEAN ERROR: "'+o+'" is an invalid definition key. The key must be alphabetical. (A-Z)\nDefinition Source: { ja : "'+d[u[g]].querySelector(".def-ja").innerHTML.replace(/<span class="def-en">.*?<\/span>/,"")+'", en : "'+d[u[g]].querySelector(".def-en").innerHTML+'" }')),(a=d[u[g]].innerHTML.match(/<span class="def-en">.*?<\/span>/))[0]&&(d[u[g]].innerHTML=d[u[g]].innerHTML.replace(/<span class="def-en">.*?<\/span>/,"").replace(/(<input.*?<\/span>)/,"$1"+a[0]+" "),r.appendChild(d[u[g]]),Genki.appendix.jisho.cache.box[d[u[g]].dataset.def].en=d[u[g]].firstChild,Genki.appendix.jisho.cache.group[c]||(Genki.appendix.jisho.cache.group[c]=[]),Genki.appendix.jisho.cache.group[c].push(d[u[g]].firstChild),Genki.appendix.jisho.cache.search.en.push(d[u[g]]));i.getElementById("list-"+c).appendChild(r);for(var f=i.querySelectorAll(".dictionary-group .section-title"),g=0,k=f.length;g<k;g++)f[g].insertAdjacentHTML("beforeend",'<span class="definition-count">('+Genki.appendix.jisho.cache.group[f[g].id.replace("section-","")].length+")</span>");i.getElementById("total-definitions").innerHTML="<strong>"+Genki.appendix.jisho.cache.search.ja.length+"</strong>",Genki.appendix.jisho.restoreSettings(),AddJumpArrowsTo(".dictionary-group .section-title","dictionary-top","Return to the top of the dictionary"),i.getElementById("exercise-title").insertAdjacentHTML("beforeend"," Word Practice"),Genki.appendix.jisho.cache.search.res_ja=i.getElementById("dict-search-results-ja"),Genki.appendix.jisho.cache.search.res_en=i.getElementById("dict-search-results-en"),Genki.appendix.jisho.cache.search.hit_ja=i.getElementById("dict-search-hits-ja"),Genki.appendix.jisho.cache.search.hit_en=i.getElementById("dict-search-hits-en"),Genki.appendix.finishedLoading()},switchMode:function(e,s){var n={button:i.getElementById("ja-mode"),dict:i.getElementById("japanese-english")},a={button:i.getElementById("en-mode"),dict:i.getElementById("english-japanese")};"ja"==e&&"ja"!=Genki.appendix.jisho.mode?(n.button.className+=" active-mode",a.button.className=a.button.className.replace(" active-mode",""),a.dict.className+=" dict-hidden",n.dict.className=n.dict.className.replace(" dict-hidden","")):"en"==e&&"en"!=Genki.appendix.jisho.mode&&(a.button.className+=" active-mode",n.button.className=n.button.className.replace(" active-mode",""),n.dict.className+=" dict-hidden",a.dict.className=a.dict.className.replace(" dict-hidden","")),Genki.appendix.jisho.mode=e,!s&&storageOK&&(localStorage.genkiJishoMode=e)},updateCheckboxes:function(e,i,s){var n,a=Genki.appendix.jisho.cache.box[i],t=Genki.appendix.jisho.selected.indexOf(i);if(e.checked){for(n in a)e!=a[n]&&(a[n].checked=!0);-1==t&&Genki.appendix.jisho.selected.push(i)}else if(!e.checked){for(n in a)e!=a[n]&&(a[n].checked=!1);-1!=t&&Genki.appendix.jisho.selected.splice(t,1)}!s&&storageOK&&(localStorage.selectedDefinitions=Genki.appendix.jisho.selected)},selectAll:function(e,i){var s,n,a,t=i?Genki.appendix.jisho.cache.group[i]:Genki.appendix.jisho.cache.box;if(t){if(i)for(s=0,n=t.length;s<n;s++)t[s].checked!=e&&(t[s].checked=e,Genki.appendix.jisho.updateCheckboxes(t[s],t[s].parentNode.dataset.def,!0));else for(a in t)t[a].ja.checked!=e&&(t[a].ja.checked=e,Genki.appendix.jisho.updateCheckboxes(t[a].ja,t[a].ja.parentNode.dataset.def,!0));storageOK&&(localStorage.selectedDefinitions=Genki.appendix.jisho.selected)}},toggleList:function(e,i){if(i){var s=(r=e.parentNode.parentNode.parentNode.parentNode).querySelectorAll(".dictionary-group .group-selectors"),n=r.querySelectorAll(".dictionary-group .word-list"),a=r.querySelectorAll(".dictionary-group .toggle-word-list"),t=0,l=n.length;if(/Show/.test(e.innerHTML)){for(;t<l;t++)n[t].className=n[t].className.replace(" hidden",""),s[t].className=s[t].className.replace(" hidden",""),a[t].innerHTML=a[t].innerHTML.replace("Show","Hide");e.innerHTML=e.innerHTML.replace("Show","Hide")}else{for(;t<l;t++)/hidden/.test(n[t].className)||(n[t].className+=" hidden"),/hidden/.test(s[t].className)||(s[t].className+=" hidden"),a[t].innerHTML=a[t].innerHTML.replace("Hide","Show");e.innerHTML=e.innerHTML.replace("Hide","Show")}}else{var r;s=(r=e.parentNode.parentNode).querySelector(".group-selectors"),n=r.querySelector(".word-list");/hidden/.test(n.className)?(n.className=n.className.replace(" hidden",""),s.className=s.className.replace(" hidden",""),e.innerHTML=e.innerHTML.replace("Show","Hide")):(n.className+=" hidden",s.className+=" hidden",e.innerHTML=e.innerHTML.replace("Hide","Show"))}},search:function(s,n,a){Genki.appendix.jisho.searchTimeout&&e.clearTimeout(Genki.appendix.jisho.searchTimeout),Genki.appendix.jisho.searchTimeout=e.setTimeout(function(){var e,t,l=i.createDocumentFragment(),r=Genki.appendix.jisho.cache.search["res_"+n],c=Genki.appendix.jisho.cache.search["hit_"+n],o=Genki.appendix.jisho.cache.search[n],p=o.length,u=0,d=0;for(e in Genki.appendix.jisho.cache.box)Genki.appendix.jisho.cache.box[e]["search_"+n]&&delete Genki.appendix.jisho.cache.box[e]["search_"+n];if(Genki.appendix.jisho.cache.group["search_"+n]=[],r.innerHTML="",s)for(;d<p;d++)-1!=o[d].innerText.toLowerCase().indexOf(s.toLowerCase())&&(t=o[d].cloneNode(!0),l.appendChild(t),Genki.appendix.jisho.cache.box[o[d].dataset.def]["search_"+n]=t.firstChild,Genki.appendix.jisho.cache.group["search_"+n].push(t.firstChild),u++);if(!a&&!l.childNodes.length&&s&&/[\u3400-\u9faf]/.test(s)){var h=s.match(/[\u3400-\u9faf]+/);h&&h[0]&&Genki.appendix.jisho.search(h[0],n,!0)}else l.childNodes.length?(r.parentNode.querySelector(".group-selectors").style.visibility="",r.appendChild(l)):(r.parentNode.querySelector(".group-selectors").style.visibility="hidden",r.innerHTML=s?'<li>No results found for "'+s+'".</li>':""),c.innerHTML=u?"("+u+") ":"";delete Genki.appendix.jisho.searchTimeout},300)},launchExercise:function(){for(var e=Genki.appendix.jisho.selected.length,s=0,n=[];s<e;s++)i.querySelector('#japanese-english [data-def="'+Genki.appendix.jisho.selected[s]+'"]')||n.push(Genki.appendix.jisho.selected[s]);if(n.length){for(;n.length;)Genki.appendix.jisho.selected.splice(Genki.appendix.jisho.selected.indexOf(n[0]),1),n.splice(0,1);storageOK&&(localStorage.selectedDefinitions=Genki.appendix.jisho.selected),e=Genki.appendix.jisho.selected.length}e<5?GenkiModal.open({title:"Please select more words.",content:"Please select <b>"+(5-e)+"</b> more word"+(5-e==1?"":"s")+" to begin a practice exercise."}):GenkiModal.open({title:"Begin Practice?",content:"Are you ready to practice your selected words?",buttonText:"Yes",keepOpen:!0,callback:function(){for(var s,n,a=Genki.appendix.jisho.selected,t={},l=0;l<e;l++)n=(s=i.querySelector('#japanese-english [data-def="'+a[l]+'"]')).querySelector(".def-furi i"),t[s.querySelector(".def-ja").innerHTML.replace(/<i>.*?<\/i>/,"")+(n?"|"+n.innerHTML:"")]=s.querySelector(".def-en").innerHTML;Genki.generateQuiz({format:"vocab",type:["drag","multi","writing","fill"],info:[Genki.lang.std_drag,Genki.lang.vocab_multi,Genki.lang.vocab_writing,Genki.lang.vocab_fill],quizlet:t}),Genki.appendix.showExercise()}})},restoreSettings:function(){storageOK&&(localStorage.genkiJishoMode&&"ja"!=localStorage.genkiJishoMode&&Genki.appendix.jisho.switchMode(localStorage.genkiJishoMode,!0),localStorage.selectedDefinitions&&(Genki.appendix.jisho.selected=localStorage.selectedDefinitions.split(",")))}},studyMap:function(){GenkiModal.open({title:"Study Map of Japan?",content:'Are you ready to study the map of Japan? Please select the quiz you would like to take below.<br><br><div class="center"><select id="selected-map"><option value="1"'+(storageOK&&"1"==localStorage.genkiSelectedMap?" selected":"")+'>Hokkaido and Tohoku Region (1-8)</option><option value="2"'+(storageOK&&"2"==localStorage.genkiSelectedMap?" selected":"")+'>Kanto Region (9-15)</option><option value="3"'+(storageOK&&"3"==localStorage.genkiSelectedMap?" selected":"")+'>Chubu Region (16-23)</option><option value="4"'+(storageOK&&"4"==localStorage.genkiSelectedMap?" selected":"")+'>Kinki Region (24-30)</option><option value="5"'+(storageOK&&"5"==localStorage.genkiSelectedMap?" selected":"")+'>Chugoku and Shikoku Region (31-39)</option><option value="6"'+(storageOK&&"6"==localStorage.genkiSelectedMap?" selected":"")+'>Kyushu Region (40-47)</option><option value="7"'+(storageOK&&"7"==localStorage.genkiSelectedMap?" selected":"")+'>Cities and Landmarks 1 (48-58)</option><option value="8"'+(storageOK&&"8"==localStorage.genkiSelectedMap?" selected":"")+">Cities and Landmarks 2 (59-69)</option></select></div>",callback:function(){var e,s,n,a,t,l,r=i.getElementById("selected-map"),c=i.getElementById("exercise-title"),o=r.options[r.selectedIndex].innerHTML.replace(/\(.*?\)$/,"Quiz"),p=+r.value,u=[],d=[];switch(storageOK&&(localStorage.genkiSelectedMap=p),p){case 1:e="1-8",n=[{question:'<span class="inline-furi">北海道<i class="furigana">ほっかいどう</i></span>',answers:["A1"]},{question:'<span class="inline-furi">青森県<i class="furigana">あおもりけん</i></span>',answers:["A2"]},{question:'<span class="inline-furi">秋田県<i class="furigana">あきたけん</i></span>',answers:["A3"]},{question:'<span class="inline-furi">岩手県<i class="furigana">いわてけん</i></span>',answers:["A4"]},{question:'<span class="inline-furi">山形県<i class="furigana">やまがたけん</i></span>',answers:["A5"]},{question:'<span class="inline-furi">宮城県<i class="furigana">みやぎけん</i></span>',answers:["A6"]},{question:'<span class="inline-furi">新潟県<i class="furigana">にいがたけん</i></span>',answers:["A7"]},{question:'<span class="inline-furi">福島県<i class="furigana">ふくしまけん</i></span>',answers:["A8"]}];break;case 2:e="9-15",n=[{question:'<span class="inline-furi">群馬県<i class="furigana">ぐんまけん</i></span>',answers:["A9"]},{question:'<span class="inline-furi">栃木県<i class="furigana">とちぎけん</i></span>',answers:["A10"]},{question:'<span class="inline-furi">茨城県<i class="furigana">いばらきけん</i></span>',answers:["A11"]},{question:'<span class="inline-furi">埼玉県<i class="furigana">さいたまけん</i></span>',answers:["A12"]},{question:'<span class="inline-furi">東京都<i class="furigana">とうきょうと</i></span>',answers:["A13"]},{question:'<span class="inline-furi">千葉県<i class="furigana">ちばけん</i></span>',answers:["A14"]},{question:'<span class="inline-furi">神奈川県<i class="furigana">かながわけん</i></span>',answers:["A15"]}];break;case 3:e="16-23",n=[{question:'<span class="inline-furi">山梨県<i class="furigana">やまなしけん</i></span>',answers:["A16"]},{question:'<span class="inline-furi">長野県<i class="furigana">ながのけん</i></span>',answers:["A17"]},{question:'<span class="inline-furi">静岡県<i class="furigana">しずおかけん</i></span>',answers:["A18"]},{question:'<span class="inline-furi">富山県<i class="furigana">とやまけん</i></span>',answers:["A19"]},{question:'<span class="inline-furi">石川県<i class="furigana">いしかわけん</i></span>',answers:["A20"]},{question:'<span class="inline-furi">福井県<i class="furigana">ふくいけん</i></span>',answers:["A21"]},{question:'<span class="inline-furi">岐阜県<i class="furigana">ぎふけん</i></span>',answers:["A22"]},{question:'<span class="inline-furi">愛知県<i class="furigana">あいちけん</i></span>',answers:["A23"]}];break;case 4:e="24-30",n=[{question:'<span class="inline-furi">滋賀県<i class="furigana">しがけん</i></span>',answers:["A24"]},{question:'<span class="inline-furi">三重県<i class="furigana">みえけん</i></span>',answers:["A25"]},{question:'<span class="inline-furi">京都府<i class="furigana">きょうとけん</i></span>',answers:["A26"]},{question:'<span class="inline-furi">大阪府<i class="furigana">おおさかふ</i></span>',answers:["A27"]},{question:'<span class="inline-furi">奈良県<i class="furigana">ならけん</i></span>',answers:["A28"]},{question:'<span class="inline-furi">和歌山県<i class="furigana">わかやまけん</i></span>',answers:["A29"]},{question:'<span class="inline-furi">兵庫県<i class="furigana">ひょうごけん</i></span>',answers:["A30"]}];break;case 5:e="31-39",n=[{question:'<span class="inline-furi">鳥取県<i class="furigana">とっとりけん</i></span>',answers:["A31"]},{question:'<span class="inline-furi">島根県<i class="furigana">しまねけん</i></span>',answers:["A32"]},{question:'<span class="inline-furi">岡山県<i class="furigana">おかやまけん</i></span>',answers:["A33"]},{question:'<span class="inline-furi">広島県<i class="furigana">ひろしまけん</i></span>',answers:["A34"]},{question:'<span class="inline-furi">山口県<i class="furigana">やまぐちけん</i></span>',answers:["A35"]},{question:'<span class="inline-furi">香川県<i class="furigana">かがわけん</i></span>',answers:["A36"]},{question:'<span class="inline-furi">徳島県<i class="furigana">とくしまけん</i></span>',answers:["A37"]},{question:'<span class="inline-furi">愛媛県<i class="furigana">えひめけん</i></span>',answers:["A38"]},{question:'<span class="inline-furi">高知県<i class="furigana">こうちけん</i></span>',answers:["A39"]}];break;case 6:e="40-47",n=[{question:'<span class="inline-furi">福岡県<i class="furigana">ふくおかけん</i></span>',answers:["A40"]},{question:'<span class="inline-furi">佐賀県<i class="furigana">さがけん</i></span>',answers:["A41"]},{question:'<span class="inline-furi">長崎県<i class="furigana">ながさきけん</i></span>',answers:["A42"]},{question:'<span class="inline-furi">大分県<i class="furigana">おおいたけん</i></span>',answers:["A43"]},{question:'<span class="inline-furi">熊本県<i class="furigana">くまもとけん</i></span>',answers:["A44"]},{question:'<span class="inline-furi">宮崎県<i class="furigana">みやざきけん</i></span>',answers:["A45"]},{question:'<span class="inline-furi">鹿児島県<i class="furigana">かごしまけん</i></span>',answers:["A46"]},{question:'<span class="inline-furi">沖縄県<i class="furigana">おきなわけん</i></span>',answers:["A47"]}];break;case 7:e="48-58",n=[{question:'<span class="inline-furi">沖縄（琉球舞踊）<i class="furigana">おきなわ（りゅうきゅうぶよう）</i></span>',answers:["A48"]},{question:'<span class="inline-furi">桜島<i class="furigana">さくらじま</i></span>',answers:["A49"]},{question:'<span class="inline-furi">長崎（平和の像）<i class="furigana">ながさき（へいわのぞう）</i></span>',answers:["A50"]},{question:'<span class="inline-furi">伊万里（伊万里焼）<i class="furigana">いまり（いまりやき）</i></span>',answers:["A51"]},{question:'<span class="inline-furi">広島（原爆ドーム）<i class="furigana">ひろしま（げんばくドーム）</i></span>',answers:["A52"]},{question:'<span class="inline-furi">京都（東寺）<i class="furigana">きょうと（とうじ）</i></span>',answers:["A53"]},{question:'<span class="inline-furi">姫路（姫路城）<i class="furigana">ひめじ（ひめじじょう）</i></span>',answers:["A54"]},{question:'<span class="inline-furi">日本アルプス<i class="furigana">にほんアルプス</i></span>',answers:["A55"]},{question:'<span class="inline-furi">札幌（雪祭り）<i class="furigana">さっぽろ（ゆくまつり）</i></span>',answers:["A56"]},{question:'<span class="inline-furi">松島<i class="furigana">まつしま</i></span>',answers:["A57"]},{question:'<span class="inline-furi">日光（東照宮）<i class="furigana">にっこう（とうしょうぐう）</i></span>',answers:["A58"]}];break;case 8:e="59-69",n=[{question:'<span class="inline-furi">富士山<i class="furigana">ふじさん</i></span>',answers:["A59"]},{question:'<span class="inline-furi">白川郷<i class="furigana">しらかわごう</i></span>',answers:["A60"]},{question:'<span class="inline-furi">奈良（大仏）<i class="furigana">なら（だいぶつ）</i></span>',answers:["A61"]},{question:'<span class="inline-furi">大阪<i class="furigana">おおさか</i></span>',answers:["A62"]},{question:'<span class="inline-furi">名古屋<i class="furigana">なごや</i></span>',answers:["A63"]},{question:'<span class="inline-furi">鎌倉<i class="furigana">かまくら</i></span>',answers:["A64"]},{question:'<span class="inline-furi">横浜<i class="furigana">よこはま</i></span>',answers:["A65"]},{question:'<span class="inline-furi">東京<i class="furigana">とうきょう</i></span>',answers:["A66"]},{question:'<span class="inline-furi">金沢<i class="furigana">かなざわ</i></span>',answers:["A67"]},{question:'<span class="inline-furi">琵琶湖<i class="furigana">びわこ</i></span>',answers:["A68"]},{question:'<span class="inline-furi">神戸<i class="furigana">こうべ</i></span>',answers:["A69"]}]}for((e=e.split("-"))[0]=+e[0],e[1]=+e[1],u=[];e[0]<=e[1];e[0]++)u.push(e[0]);for(;n.length;){for(n[a=Math.floor(Math.random()*n.length)].question="Where is "+n[a].question+" located on the map?",t=3,(s=u.slice()).splice(s.indexOf(+n[a].answers[0].replace("A","")),1);t-- >0;)l=Math.floor(Math.random()*s.length),n[a].answers.push(s[l]),s.splice(l,1);d.push(n[a]),n.splice(a,1)}c.innerHTML=c.innerHTML.replace(/- .*/,"- "+o),Genki.appendix.showExercise(),Genki.generateQuiz({type:"multi",info:"Look at the map and answer the questions about each location.",quizlet:d})}})},studyChart:function(e){var s=Genki.active.exercise[1];GenkiModal.open({title:"Study "+s+"?",content:"Are you ready to study the "+s+"?",callback:function(){var s,n;switch(e){case"numbers":n="Fill in the following chart with the correct numbers and sound changes.",s=Genki.appendix.numbers_chart;break;case"conjugation":n="Conjugate all the verbs into the correct forms. If you haven't learned a specific form yet, only focus on the ones that you have learned and then check your answers.",s=Genki.appendix.conjugation_chart}i.getElementById("exercise-title").insertAdjacentHTML("beforeend"," Quiz"),Genki.appendix.showExercise(),Genki.generateQuiz({type:"fill",info:n,quizlet:s})}})},showExercise:function(){i.getElementById("appendix-tool").style.display="none",i.getElementById("exercise").style.display=""},finishedLoading:function(){var e=i.querySelector(".loading");e.className=e.className.replace("loading","")}},i.getElementById("appendix-tool").appendChild(i.querySelector(".more-exercises").cloneNode(!0))}(window,document);